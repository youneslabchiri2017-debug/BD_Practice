{"class":"org.apache.spark.ml.feature.SQLTransformer","timestamp":1767039156001,"sparkVersion":"4.0.1","uid":"SQLTransformer_ec890291efcc","paramMap":{"statement":"\nSELECT \n    Year, Month, DayofMonth, DayOfWeek, DepTime, CRSDepTime, CRSArrTime, UniqueCarrier, CRSElapsedTime, ArrDelay, DepDelay, Origin, Dest, Distance,\n    -- 1. Calculamos la mediana dinámicamente y si es NULL (columna vacía) ponemos 0\n    COALESCE(\n        (SELECT percentile_approx(TaxiOut, 0.5) FROM __THIS__), \n        0\n    ) AS TaxiOut,\n\n    -- 2. Cálculo de TakeOffTime usando la columna limpia anterior\n    CAST(date_format(\n        to_timestamp(concat(Year, lpad(Month, 2, '0'), lpad(DayofMonth, 2, '0'), lpad(CRSDepTime, 4, '0')), 'yyyyMMddHHmm') \n        + (COALESCE(CAST(DepDelay AS INT), 0) + COALESCE(CAST(TaxiOut AS INT), 0)) * INTERVAL 1 MINUTE, \n    'HHmm') AS INT) as TakeOffTime,\n    \n    -- 3. Cálculo de LandingEst\n    CAST(date_format(\n        to_timestamp(concat(Year, lpad(Month, 2, '0'), lpad(DayofMonth, 2, '0'), lpad(CRSDepTime, 4, '0')), 'yyyyMMddHHmm') \n        + COALESCE(CAST(CRSElapsedTime AS INT), 0) * INTERVAL 1 MINUTE, \n    'HHmm') AS INT) as LandingEst\nFROM __THIS__\n"},"defaultParamMap":{}}
